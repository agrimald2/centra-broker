import{r as v,o,c as a,a as l,u as w,w as k,F as m,Z as A,b as e,d as c,f as d,g as r,v as C,e as g,t as u,h as V,l as h}from"./app-ae156985.js";import{A as N}from"./AdminLayout-50c6fa83.js";import{B as F}from"./Breadcrumb-fb6a0ca1.js";import f from"./AddCustomer-bc725c29.js";import I from"./AddPeopleToInsurance-e5215d17.js";import b from"./AddNewAsset-6f94c2e8.js";import x from"./AddFile-581dab2c.js";import"./_plugin-vue_export-helper-c27b6911.js";const B={class:"space-y-12"},M={class:"border-b border-gray-900/10 pb-12"},P=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Crear una póliza nueva",-1),U=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Asegúrate de llenar todos los campos ",-1),E={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},H={class:"sm:col-span-3"},L=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[r(" Número de póliza "),e("button",{type:"button",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),S={class:"mt-2"},z={class:"bg-white flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},Z=e("span",{class:"flex select-none items-center pl-3 text-gray-500 sm:text-sm"},"N° | ",-1),T={class:"sm:col-span-3"},$={for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"},D=e("i",{class:"fa-solid fa-user-plus font-xl"},null,-1),O=[D],j={class:"mt-2"},q={class:"sm:col-span-2"},G=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[r(" Companía de Seguros "),e("button",{type:"button",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),J={class:"mt-2"},K={class:"sm:col-span-2"},Q=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Inicio de Vigencia ",-1),R={class:"mt-4"},W={class:"relative"},X=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),Y={class:"sm:col-span-2"},ee=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Fin de Vigencia ",-1),se={class:"mt-4"},te={class:"relative"},ne=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),ie={class:"sm:col-span-2"},oe=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[r(" Tipo de comisión "),e("button",{type:"button",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),ae={class:"mt-2"},le={class:"sm:col-span-3"},re={class:"mt-2"},ce=e("option",{value:"1",selected:""},"% | PORCENTAJE",-1),de=e("option",{value:"2"},"N° | NUMÉRICA",-1),ue=[ce,de],_e={class:"sm:col-span-2"},pe=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[r(" Comisión "),e("button",{type:"button",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),me={class:"mt-2"},ge={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},ye=e("span",{class:"flex select-none items-center pl-3 text-gray-500 sm:text-sm"},"% |",-1),he={class:"sm:col-span-1 col-span"},fe=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"}," N° Cuotas ",-1),be={class:"mt-5"},xe={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},ve=e("span",{class:"flex select-none items-center pl-3 text-gray-700 sm:text-sm"},"N°",-1),we={class:"sm:col-span-1"},ke=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"}," Tasa de riesgo ",-1),Ae={class:"mt-5"},Ce={class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},Ve=e("span",{class:"flex select-none items-center pl-3 text-gray-700 sm:text-sm"},"%",-1),Ne={class:"border-b border-gray-900/10 pb-12"},Fe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Activos",-1),Ie=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Lista de activos Asegurados ",-1),Be=e("i",{class:"ml-2 fa-solid fa-plus font-xl"},null,-1),Me={class:"sm:col-span-3 overflow-x-auto"},Pe={key:0,class:"w-full text-sm text-left text-gray-500"},Ue=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," # "),e("th",{scope:"col",class:"px-6 py-3"}," Valor Asegurado "),e("th",{scope:"col",class:"px-6 py-3"}," Fecha de Vigencia "),e("th",{scope:"col",class:"px-6 py-3"}," Atributos "),e("th",{scope:"col",class:"px-6 py-3"}," Acciones ")])],-1),Ee={class:"bg-white border-b hover:bg-gray-50"},He={scope:"row",class:"px-6 py-4"},Le={class:"px-6 py-4"},Se={class:"px-6 py-4"},ze={class:"px-6 py-4"},Ze={class:"w-full text-sm text-left text-gray-500 table"},Te={class:"text-xs text-gray-700 uppercase bg-gray-100"},$e={scope:"col",class:"px-6 py-3 text-center"},De={key:0},Oe={key:1},je={class:"px-6 py-4"},qe=["onClick"],Ge=e("br",null,null,-1),Je={key:0,class:"bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full dark:bg-red-900 dark:text-red-300"},Ke={key:1,class:"text-red-500"},Qe={class:"border-b border-gray-900/10 pb-12"},Re=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Archivos de la póliza",-1),We=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Imágenes, PDF's, Excel y cualquier tipo de documento que esté relacionado a la poliza ",-1),Xe=e("i",{class:"ml-2 fa-solid fa-plus font-xl"},null,-1),Ye={class:"sm:col-span-3"},es={class:"mt-10 grid grid-cols-8 gap-y-4"},ss={class:"sm:col-span-4 md:col-span-2 col-span-4"},ts={class:"w-48 text-gray-900 bg-white border border-gray-200 rounded-lg"},ns=["onClick"],is=e("i",{class:"fa-solid fa-file mr-2"},null,-1),os=e("br",null,null,-1),as={class:"mt-6 flex items-center justify-end gap-x-6"},ls=e("button",{type:"button",class:"text-sm font-semibold leading-6 text-gray-900"},"Cancelar",-1),rs={components:{AddCustomer:f,AddPeopleToInsurance:I,AddNewAsset:b,AddFile:x},props:["breadcrumbs","general_settings","insurance_policies_data","insurancePolicy","insurance_billing_contact","insuranced_people","insurance_policies_data","assets"],data(){return{insurance_policy:{number:this.insurancePolicy.number,insurance_policy_data:{customer_id:this.insurance_policies_data[0].customer_id,insurance_policies_status_id:this.insurance_policies_data[0].status_id,insurance_company_id:this.insurance_policies_data[0].insurance_company_id,start_date:this.insurance_policies_data[0].start_date,end_date:this.insurance_policies_data[0].end_date,comission_type_id:this.insurance_policies_data[0].comission_type_id,comission:this.insurance_policies_data[0].comission,number_of_installments:this.insurance_policies_data[0].number_of_installments,risk_rate:this.insurance_policies_data[0].risk_rate,insurance_policy_insuranced_people:[],assets:this.insurance_policies_data[0].assets,files:[],insurance_policies_data_files:[]}},customers:[],insurance_companies:[]}},methods:{async submit(){try{const t=await axios.put(`/admin/insurance_policies/update/${this.insurancePolicy.id}`,this.insurance_policy);window.location.href="/admin/insurance_policies"}catch(t){console.log(t),window.location.href="/admin/insurance_policies"}},showModal(t){let s=document.getElementById(t);s.classList.remove("slide-out-bck-center"),s.classList.remove("no-display")},async getCustomers(){try{const t=await axios.get("/api/customer");this.customers=t.data}catch(t){console.log(t)}},async getInsuranceCompanies(){try{const t=await axios.get("/api/insurance_companies");this.insurance_companies=t.data}catch(t){console.log(t)}},handleNewFile(t){this.insurance_policy.insurance_policy_data.files.push(t)},removeFile(t){const s=this.insurance_policy.insurance_policy_data.files.findIndex(n=>n.name===t.name);s!==-1&&this.insurance_policy.insurance_policy_data.files.splice(s,1)},handleNewAsset(t){this.insurance_policy.insurance_policy_data.assets.push(t)},removeAsset(t){const s=this.insurance_policy.insurance_policy_data.assets.findIndex(n=>n.asset_type_id===t.asset_type_id&&n.insured_amount===t.insured_amount&&n.vigency_date===t.vigency_date);s!==-1&&(this.insurance_policy.insurance_policy_data.assets[s].deleted_at=new Date().toISOString())},handleNewCustomer(t){this.customers.push(t),this.insurance_policy.insurance_policy_data.customer_id=t.id},handleNewPeople(t){console.table(t),t.type_id===1?(this.removePeopleByType(1),this.insurance_policy.insurance_policy_data.insurance_policy_people.push(t),this.setBillingContact(t)):t.type_id===2&&(this.insurance_policy.insurance_policy_data.insurance_policy_people.push(t),this.addInsurancedPeople(t))},removePeopleByType(t){const s=this.insurance_policy.insurance_policy_data.insurance_policy_people.findIndex(n=>n.type_id===t);s!==-1&&this.insurance_policy.insurance_policy_data.insurance_policy_people.splice(s,1)},setBillingContact(t){this.insurance_policy.insurance_policy_data.insurance_policy_billing_contact=t},addInsurancedPeople(t){this.insurance_policy.insurance_policy_data.insurance_policy_insuranced_people.push(t)},removeInsurancedPeople(t){this.removePeopleFromList(t,this.insurance_policy.insurance_policy_data.insurance_policy_insuranced_people),this.removePeopleFromList(t,this.insurance_policy.insurance_policy_data.insurance_policy_people)},removePeopleFromList(t,s){const n=s.findIndex(_=>_.document_number===t.document_number);n!==-1&&s.splice(n,1)}},mounted(){this.getCustomers(),this.getInsuranceCompanies()}},hs=Object.assign(rs,{__name:"Edit",setup(t){return(s,n)=>{const _=v("v-select");return o(),a(m,null,[l(w(A),{title:"Editar Póliza"}),l(N,null,{default:k(()=>[l(F,{breadcrumbs:t.breadcrumbs},null,8,["breadcrumbs"]),e("form",{class:"px-2",onSubmit:n[13]||(n[13]=h((...i)=>s.submit&&s.submit(...i),["prevent"]))},[e("div",B,[e("div",M,[P,U,e("div",E,[e("div",H,[L,e("div",S,[e("div",z,[Z,c(e("input",{type:"text",name:"number",id:"number",autocomplete:"number","onUpdate:modelValue":n[0]||(n[0]=i=>s.insurance_policy.number=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"000001"},null,512),[[d,s.insurance_policy.number]])])])]),e("div",T,[e("label",$,[r(" Contratante "),e("button",{type:"button",onClick:n[1]||(n[1]=i=>s.showModal("AddCustomer")),class:"ml-2 text-white bg-green-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},O),l(f,{id:"AddCustomer",onCustomerAdded:s.handleNewCustomer},null,8,["onCustomerAdded"])]),e("div",j,[l(_,{modelValue:s.insurance_policy.insurance_policy_data.customer_id,"onUpdate:modelValue":n[2]||(n[2]=i=>s.insurance_policy.insurance_policy_data.customer_id=i),options:s.customers,reduce:i=>i.id,label:"name"},null,8,["modelValue","options","reduce"])])]),e("div",q,[G,e("div",J,[l(_,{modelValue:s.insurance_policy.insurance_policy_data.insurance_company_id,"onUpdate:modelValue":n[3]||(n[3]=i=>s.insurance_policy.insurance_policy_data.insurance_company_id=i),options:s.insurance_companies,reduce:i=>i.id,label:"name"},null,8,["modelValue","options","reduce"])])]),e("div",K,[Q,e("div",R,[e("div",W,[X,c(e("input",{type:"date","onUpdate:modelValue":n[4]||(n[4]=i=>s.insurance_policy.insurance_policy_data.start_date=i),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[d,s.insurance_policy.insurance_policy_data.start_date]])])])]),e("div",Y,[ee,e("div",se,[e("div",te,[ne,c(e("input",{type:"date","onUpdate:modelValue":n[5]||(n[5]=i=>s.insurance_policy.insurance_policy_data.end_date=i),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[d,s.insurance_policy.insurance_policy_data.end_date]])])])]),e("div",ie,[oe,e("div",ae,[e("div",le,[e("div",re,[c(e("select",{id:"country",name:"country",autocomplete:"country-name","onUpdate:modelValue":n[6]||(n[6]=i=>s.insurance_policy.insurance_policy_data.comission_type_id=i),class:"bg-transparent block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6"},ue,512),[[C,s.insurance_policy.insurance_policy_data.comission_type_id]])])])])]),e("div",_e,[pe,e("div",me,[e("div",ge,[ye,c(e("input",{type:"number",name:"number",id:"number",autocomplete:"number","onUpdate:modelValue":n[7]||(n[7]=i=>s.insurance_policy.insurance_policy_data.comission=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"12.0"},null,512),[[d,s.insurance_policy.insurance_policy_data.comission]])])])]),e("div",he,[fe,e("div",be,[e("div",xe,[ve,c(e("input",{type:"number","onUpdate:modelValue":n[8]||(n[8]=i=>s.insurance_policy.insurance_policy_data.number_of_installments=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"5"},null,512),[[d,s.insurance_policy.insurance_policy_data.number_of_installments]])])])]),e("div",we,[ke,e("div",Ae,[e("div",Ce,[Ve,c(e("input",{type:"text","onUpdate:modelValue":n[9]||(n[9]=i=>s.insurance_policy.insurance_policy_data.risk_rate=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"2.8"},null,512),[[d,s.insurance_policy.insurance_policy_data.risk_rate]])])])])])]),e("div",Ne,[Fe,Ie,e("button",{type:"button",onClick:n[10]||(n[10]=i=>s.showModal("NewAsset")),class:"mt-1 text-white bg-indigo-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[r(" Añadir Activo "),Be]),l(b,{id:"NewAsset",onAssetAdded:s.handleNewAsset},null,8,["onAssetAdded"]),e("div",Me,[s.insurance_policy.insurance_policy_data.assets.length>0?(o(),a("table",Pe,[Ue,e("tbody",null,[(o(!0),a(m,null,g(s.insurance_policy.insurance_policy_data.assets,(i,y)=>(o(),a("tr",Ee,[e("td",He," # "+u(y+1),1),e("td",Le,u(i.insured_amount),1),e("td",Se,u(i.vigency_date),1),e("td",ze,[e("table",Ze,[e("thead",Te,[e("tr",null,[(o(!0),a(m,null,g(i.assets_attributes_data,p=>(o(),a("th",$e,[p.value?(o(),a("span",De,u(p.value),1)):(o(),a("span",Oe,u(p),1))]))),256))])])])]),e("td",je,[e("i",{onClick:p=>s.removeAsset(i),class:"fa-solid fa-trash text-3xl text-red-500 cursor-pointer ml-2"},null,8,qe),r(),Ge,i.deleted_at?(o(),a("span",Je,"Eliminado")):V("",!0)])]))),256))])])):(o(),a("h1",Ke," No haz añadido ningún activo "))])]),e("div",Qe,[Re,We,e("button",{type:"button",onClick:n[11]||(n[11]=i=>s.showModal("AddFile")),class:"mt-1 text-white bg-indigo-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[r(" Añadir Archivo "),Xe]),l(x,{id:"AddFile",onFileAdded:s.handleNewFile},null,8,["onFileAdded"]),e("div",Ye,[e("div",es,[(o(!0),a(m,null,g(s.insurance_policy.insurance_policy_data.files,i=>(o(),a("div",ss,[e("div",ts,[e("button",{type:"button",onClick:y=>s.removeFile(i),class:"relative inline-flex items-center w-full px-4 py-2 text-sm font-medium border-b border-gray-200 rounded-t-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:focus:ring-gray-500 dark:focus:text-white"},[is,e("span",null,u(i.name.length>10?i.name.slice(0,10)+"...":i.name),1),os],8,ns)])]))),256))])])])]),e("div",as,[ls,e("button",{type:"submit",onClick:n[12]||(n[12]=h((...i)=>s.submit&&s.submit(...i),["prevent"])),class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"}," Guardar ")])],32)]),_:1})],64)}}});export{hs as default};
