import{r as v,o as c,c as r,a,u as w,w as k,F as _,Z as A,b as e,d as l,f as d,g as u,v as C,e as y,t as p,l as V}from"./app-97087de8.js";import{A as N}from"./AdminLayout-bf090ea2.js";import{B as F}from"./Breadcrumb-02492a4e.js";import f from"./AddCustomer-8a28fc98.js";import h from"./AddPeopleToInsurance-71472512.js";import b from"./AddNewAsset-d359601b.js";import I from"./AddFile-849169ff.js";import x from"./FilesDrop-6420319a.js";import"./_plugin-vue_export-helper-c27b6911.js";const B={class:"px-2"},M={class:"space-y-12"},U={class:"border-b border-gray-900/10 pb-12"},P=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Crear una póliza nueva",-1),$=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Asegúrate de llenar todos los campos ",-1),E={class:"mt-10 grid grid-cols-1 gap-x-2 gap-y-4 sm:grid-cols-6"},T={class:"sm:col-span-2"},H=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[u(" Número de póliza "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),L={class:"mt-2"},D={class:"bg-white flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},S=e("span",{class:"flex select-none items-center pl-3 text-gray-500 sm:text-sm"},"N° | ",-1),Z={class:"sm:col-span-2"},z={for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"},O=e("i",{class:"fa-solid fa-user-plus font-xl"},null,-1),j=[O],q={class:"mt-2"},J={class:"sm:col-span-2"},R={for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"},Y=e("i",{class:"fa-solid fa-user-plus font-xl"},null,-1),G=[Y],Q={class:"mt-2"},W={class:"sm:col-span-2"},X=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[u(" Companía de Seguros "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),K={class:"mt-2"},ee={class:"sm:col-span-2"},se=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Inicio de Vigencia ",-1),te={class:"mt-4"},ne={class:"relative"},ie=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),oe={class:"sm:col-span-2"},ae=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Fin de Vigencia ",-1),le={class:"mt-4"},ce={class:"relative"},re=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),de={class:"sm:col-span-2"},ue=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[u(" Tipo de comisión "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),pe={class:"mt-2"},_e={class:"sm:col-span-3"},me={class:"mt-2"},ge=e("option",{value:"1",selected:""},"% | PORCENTAJE",-1),ye=e("option",{value:"2"},"N° | NUMÉRICA",-1),fe=[ge,ye],he={class:"sm:col-span-2"},be=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[u(" Comisión "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),xe={class:"mt-2"},ve={style:{"background-color":"white"},class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},we=e("span",{class:"flex select-none items-center pl-3 text-gray-500 sm:text-sm"},"% |",-1),ke={class:"sm:col-span-1 col-span"},Ae=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"}," N° Cuotas ",-1),Ce={class:"mt-5"},Ve={style:{"background-color":"white"},class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},Ne=e("span",{class:"flex select-none items-center pl-3 text-gray-700 sm:text-sm"},"N°",-1),Fe={class:"sm:col-span-1"},Ie=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"}," Tasa de riesgo ",-1),Be={class:"mt-5"},Me={style:{"background-color":"white"},class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},Ue=e("span",{class:"flex select-none items-center pl-3 text-gray-700 sm:text-sm"},"%",-1),Pe={class:"border-b border-gray-900/10 pb-12"},$e=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Activos",-1),Ee=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Lista de activos Asegurados ",-1),Te=e("i",{class:"ml-2 fa-solid fa-plus font-xl"},null,-1),He={class:"sm:col-span-3"},Le={key:0,class:"w-full text-sm text-left text-gray-500"},De=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," Tipo "),e("th",{scope:"col",class:"px-6 py-3"}," Valor Asegurado "),e("th",{scope:"col",class:"px-6 py-3"}," Fecha de Vigencia "),e("th",{scope:"col",class:"px-6 py-3"}," Atributos "),e("th",{scope:"col",class:"px-6 py-3"}," Acciones ")])],-1),Se={class:"bg-white border-b hover:bg-gray-50"},Ze={scope:"row",class:"px-6 py-4"},ze={class:"px-6 py-4"},Oe={class:"px-6 py-4"},je={class:"px-6 py-4"},qe={class:"w-full text-sm text-left text-gray-500 table"},Je={class:"text-xs text-gray-700 uppercase bg-gray-100"},Re={scope:"col",class:"px-6 py-3 text-center"},Ye={class:"px-6 py-4"},Ge=["onClick"],Qe={key:1,class:"text-red-500"},We={class:"border-b border-gray-900/10 pb-12"},Xe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Archivos de la póliza",-1),Ke=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Imágenes, PDF's, Excel y cualquier tipo de documento que esté relacionado a la poliza ",-1),es={class:"mt-6 flex items-center justify-end gap-x-6"},ss=e("button",{type:"button",class:"text-sm font-semibold leading-6 text-gray-900"},"Cancelar",-1),ts={components:{AddCustomer:f,AddPeopleToInsurance:h,AddNewAsset:b,AddFile:I,FilesDrop:x},props:["breadcrumbs","general_settings"],data(){return{insurance_policy:{number:null,insurance_policy_data:{customer_id:null,insurance_policies_status_id:1,insurance_company_id:null,start_date:null,end_date:null,comission_type_id:1,comission:this.general_settings.comission,number_of_installments:0,risk_rate:0,insurance_policy_people:[],insurance_policy_billing_contact:{name:null},insurance_policy_insuranced_people:[],assets:[],insurance_policies_data_files:[]}},customers:[],insurance_companies:[],files:[]}},methods:{async submit(){try{const t=new FormData;Object.keys(this.insurance_policy).forEach(n=>{n!=="files"&&(n==="insurance_policy_data"?Object.keys(this.insurance_policy[n]).forEach(o=>{o==="assets"?this.insurance_policy[n][o].forEach((i,m)=>{t.append(`${n}[${o}][${m}]`,JSON.stringify(i))}):t.append(`${n}[${o}]`,this.insurance_policy[n][o])}):t.append(n,this.insurance_policy[n]))}),this.files.forEach((n,o)=>{t.append(`files[${o}]`,n)});const s=await axios.post("/admin/insurance_policies/store",t,{headers:{"Content-Type":"multipart/form-data"}});window.location.href="/admin/insurance_policies"}catch(t){console.log(t)}},showModal(t){let s=document.getElementById(t);s.classList.remove("slide-out-bck-center"),s.classList.remove("no-display")},async getCustomers(){try{const t=await axios.get("/api/customer");this.customers=t.data}catch(t){console.log(t)}},async getInsuranceCompanies(){try{const t=await axios.get("/api/insurance_companies");this.insurance_companies=t.data}catch(t){console.log(t)}},handleNewFile(t){console.dir(t),this.files=t},removeFile(t){const s=this.insurance_policy.insurance_policy_data.files.findIndex(n=>n.name===t.name);s!==-1&&this.insurance_policy.insurance_policy_data.files.splice(s,1)},handleNewAsset(t){this.insurance_policy.insurance_policy_data.assets.push(t)},removeAsset(t){const s=this.insurance_policy.insurance_policy_data.assets.findIndex(n=>n.asset_type_id===t.asset_type_id&&n.insured_amount===t.insured_amount&&n.vigency_date===t.vigency_date);s!==-1&&this.insurance_policy.insurance_policy_data.assets.splice(s,1)},handleNewCustomer(t){this.customers.push(t),this.insurance_policy.insurance_policy_data.customer_id=t.id},handleNewPeople(t){console.table(t),t.type_id===1?(this.removePeopleByType(1),this.insurance_policy.insurance_policy_data.insurance_policy_people.push(t),this.setBillingContact(t)):t.type_id===2&&(this.insurance_policy.insurance_policy_data.insurance_policy_people.push(t),this.addInsurancedPeople(t))},removePeopleByType(t){const s=this.insurance_policy.insurance_policy_data.insurance_policy_people.findIndex(n=>n.type_id===t);s!==-1&&this.insurance_policy.insurance_policy_data.insurance_policy_people.splice(s,1)},setBillingContact(t){this.insurance_policy.insurance_policy_data.insurance_policy_billing_contact=t},addInsurancedPeople(t){this.insurance_policy.insurance_policy_data.insurance_policy_insuranced_people.push(t)},removeInsurancedPeople(t){this.removePeopleFromList(t,this.insurance_policy.insurance_policy_data.insurance_policy_insuranced_people),this.removePeopleFromList(t,this.insurance_policy.insurance_policy_data.insurance_policy_people)},removePeopleFromList(t,s){const n=s.findIndex(o=>o.document_number===t.document_number);n!==-1&&s.splice(n,1)}},mounted(){this.getCustomers(),this.getInsuranceCompanies()},watch:{"insurance_policy.insurance_policy_data.start_date":function(t){if(t){let s=new Date(t);s.setFullYear(s.getFullYear()+1),this.insurance_policy.insurance_policy_data.end_date=s.toISOString().split("T")[0]}},"insurance_policy.insurance_policy_data.customer_id":function(t){const s=this.customers.find(n=>n.id===t);s&&(this.insurance_policy.insurance_policy_data.insurance_policy_billing_contact=s)}}},ps=Object.assign(ts,{__name:"Create",setup(t){return(s,n)=>{const o=v("v-select");return c(),r(_,null,[a(w(A),{title:"Crear Póliza"}),a(N,null,{default:k(()=>[a(F,{breadcrumbs:t.breadcrumbs},null,8,["breadcrumbs"]),e("form",B,[e("div",M,[e("div",U,[P,$,e("div",E,[e("div",T,[H,e("div",L,[e("div",D,[S,l(e("input",{type:"text",name:"number",id:"number",autocomplete:"number","onUpdate:modelValue":n[0]||(n[0]=i=>s.insurance_policy.number=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"000001"},null,512),[[d,s.insurance_policy.number]])])])]),e("div",Z,[e("label",z,[u(" Contratante "),e("button",{type:"button",onClick:n[1]||(n[1]=i=>s.showModal("AddCustomer")),class:"ml-2 text-white bg-green-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},j),a(f,{id:"AddCustomer",onCustomerAdded:s.handleNewCustomer},null,8,["onCustomerAdded"])]),e("div",q,[a(o,{modelValue:s.insurance_policy.insurance_policy_data.customer_id,"onUpdate:modelValue":n[2]||(n[2]=i=>s.insurance_policy.insurance_policy_data.customer_id=i),options:s.customers,style:{"background-color":"white"},reduce:i=>i.id,label:"name"},null,8,["modelValue","options","reduce"])])]),e("div",J,[e("label",R,[u(" Responsable de pago "),e("button",{type:"button",onClick:n[3]||(n[3]=i=>s.showModal("AddBillingContact")),class:"ml-2 text-white bg-green-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},G),a(h,{id:"AddBillingContact",type:1,onPeopleAdded:s.handleNewPeople},null,8,["onPeopleAdded"])]),e("div",Q,[l(e("input",{type:"text",placeholder:"Responsable de pago",disabled:"","onUpdate:modelValue":n[4]||(n[4]=i=>s.insurance_policy.insurance_policy_data.insurance_policy_billing_contact.name=i),class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[d,s.insurance_policy.insurance_policy_data.insurance_policy_billing_contact.name]])])]),e("div",W,[X,e("div",K,[a(o,{modelValue:s.insurance_policy.insurance_policy_data.insurance_company_id,"onUpdate:modelValue":n[5]||(n[5]=i=>s.insurance_policy.insurance_policy_data.insurance_company_id=i),style:{"background-color":"white"},options:s.insurance_companies,reduce:i=>i.id,label:"name"},null,8,["modelValue","options","reduce"])])]),e("div",ee,[se,e("div",te,[e("div",ne,[ie,l(e("input",{type:"date","onUpdate:modelValue":n[6]||(n[6]=i=>s.insurance_policy.insurance_policy_data.start_date=i),style:{"background-color":"white"},class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[d,s.insurance_policy.insurance_policy_data.start_date]])])])]),e("div",oe,[ae,e("div",le,[e("div",ce,[re,l(e("input",{type:"date","onUpdate:modelValue":n[7]||(n[7]=i=>s.insurance_policy.insurance_policy_data.end_date=i),style:{"background-color":"white"},class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[d,s.insurance_policy.insurance_policy_data.end_date]])])])]),e("div",de,[ue,e("div",pe,[e("div",_e,[e("div",me,[l(e("select",{id:"country",name:"country",autocomplete:"country-name",style:{"background-color":"white"},"onUpdate:modelValue":n[8]||(n[8]=i=>s.insurance_policy.insurance_policy_data.comission_type_id=i),class:"bg-transparent block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6"},fe,512),[[C,s.insurance_policy.insurance_policy_data.comission_type_id]])])])])]),e("div",he,[be,e("div",xe,[e("div",ve,[we,l(e("input",{type:"number",name:"number",id:"number",autocomplete:"number","onUpdate:modelValue":n[9]||(n[9]=i=>s.insurance_policy.insurance_policy_data.comission=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"12.0"},null,512),[[d,s.insurance_policy.insurance_policy_data.comission]])])])]),e("div",ke,[Ae,e("div",Ce,[e("div",Ve,[Ne,l(e("input",{type:"number","onUpdate:modelValue":n[10]||(n[10]=i=>s.insurance_policy.insurance_policy_data.number_of_installments=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"5"},null,512),[[d,s.insurance_policy.insurance_policy_data.number_of_installments]])])])]),e("div",Fe,[Ie,e("div",Be,[e("div",Me,[Ue,l(e("input",{type:"text","onUpdate:modelValue":n[11]||(n[11]=i=>s.insurance_policy.insurance_policy_data.risk_rate=i),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"2.8"},null,512),[[d,s.insurance_policy.insurance_policy_data.risk_rate]])])])])])]),e("div",Pe,[$e,Ee,e("button",{type:"button",onClick:n[12]||(n[12]=i=>s.showModal("NewAsset")),class:"mt-1 text-white bg-indigo-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[u(" Añadir Activo "),Te]),a(b,{id:"NewAsset",onAssetAdded:s.handleNewAsset,policy_vigency_date:s.insurance_policy.insurance_policy_data.start_date},null,8,["onAssetAdded","policy_vigency_date"]),e("div",He,[s.insurance_policy.insurance_policy_data.assets.length>0?(c(),r("table",Le,[De,e("tbody",null,[(c(!0),r(_,null,y(s.insurance_policy.insurance_policy_data.assets,(i,m)=>(c(),r("tr",Se,[e("td",Ze,p(i.asset_type_name),1),e("td",ze,p(i.insured_amount),1),e("td",Oe,p(i.vigency_date),1),e("td",je,[e("table",qe,[e("thead",Je,[e("tr",null,[(c(!0),r(_,null,y(i.assets_attributes_data,g=>(c(),r("th",Re,p(g),1))),256))])])])]),e("td",Ye,[e("i",{onClick:g=>s.removeAsset(i),class:"fa-solid fa-trash text-3xl text-red-500 cursor-pointer ml-2"},null,8,Ge)])]))),256))])])):(c(),r("h1",Qe," No haz añadido ningún activo "))])]),e("div",We,[Xe,Ke,a(x,{onFileAdded:s.handleNewFile},null,8,["onFileAdded"])])]),e("div",es,[ss,e("button",{type:"button",onClick:n[13]||(n[13]=V((...i)=>s.submit&&s.submit(...i),["prevent"])),class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"}," Guardar ")])])]),_:1})],64)}}});export{ps as default};
