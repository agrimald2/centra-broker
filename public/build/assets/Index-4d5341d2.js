import{r as y,o as l,c as n,a as u,u as x,w as v,F as d,Z as w,b as e,d as p,v as h,e as m,t as a,f as b,g as f}from"./app-4c464977.js";import{A as k}from"./AdminLayout-6c6f5c9a.js";import{B as _}from"./Breadcrumb-a7c0aa6a.js";import"./_plugin-vue_export-helper-c27b6911.js";const V={class:"shadow-md sm:rounded-lg relative"},C={class:"px-4 flex flex-wrap items-center py-4 bg-white"},A={class:"mt-4 mx-2 w-full sm:w-auto"},T=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Cliente ",-1),B=["value"],H={class:"mt-4 mx-2 w-full sm:w-auto"},E=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Tipo de Activo ",-1),I=["value"],M={class:"mt-4 mx-2 w-full sm:w-auto"},Z=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Inicio Vigencia ",-1),j={class:"relative"},D=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),L={class:"mt-4 mx-2 w-full sm:w-auto"},N=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Fin Vigencia ",-1),R={class:"relative"},U=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),F={class:"mt-4 mx-2 pt-5 w-full sm:w-auto"},P=e("span",{class:"hidden md:flex"}," Excel",-1),S=e("i",{class:"ml-2 fa-solid fa-file-excel font-xl"},null,-1),O=[P,S],$={class:"overflow-x-auto"},z={class:"w-full text-sm text-left text-gray-500"},q=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," N째 Poliza "),e("th",{scope:"col",class:"px-6 py-3"}," Inicio Vigencia "),e("th",{scope:"col",class:"px-6 py-3"}," Fin Vigencia "),e("th",{scope:"col",class:"px-6 py-3"}," Cliente "),e("th",{scope:"col",class:"px-6 py-3"}," Persona As. "),e("th",{scope:"col",class:"px-6 py-3"}," Valor As. "),e("th",{scope:"col",class:"px-6 py-3"}," Atributos "),e("th",{scope:"col",class:"px-6 py-3"}," TR | Comisi처n ")])],-1),G={class:"bg-white border-b hover:bg-gray-50"},J={scope:"row",class:"flex items-center px-6 py-4 text-gray-900 whitespace-nowrap"},K={class:"text-base font-semibold text-center"},Q=["href"],W=e("br",null,null,-1),X=e("br",null,null,-1),Y=["onClick"],ee=e("i",{class:"fa-solid fa-car-burst text-xl"},null,-1),te=[ee],se={class:"px-6 py-4"},oe={class:"px-6 py-4"},re={class:"px-6 py-4"},ae={class:"text-base font-semibold"},le=e("br",null,null,-1),ne={class:"px-6 py-4"},ie={class:"px-6 py-4"},ce={class:"w-full text-sm text-left text-gray-500 table"},de={class:"text-xs text-gray-700 uppercase bg-gray-100 border"},ue={scope:"row",class:"px-3 py-1 text-center"},pe={class:"flex items-center px-2 py-1 text-gray-900 whitespace-nowrap"},me={class:"px-6 py-4"},he={components:{Breadcrumb:_},props:["breadcrumbs"],data(){return{filter:{type:null,start_date:null,end_date:null,customer:null},assets:[],customers:[],assets_types:[]}},methods:{showModal(o){let s=document.getElementById(o);s.classList.remove("slide-out-bck-center"),s.classList.remove("no-display")},async fetchAssets(){try{const o=await axios.get("/admin/assets/get",{params:{customer:this.filter.customer,type:this.filter.type,start_date:this.filter.start_date,end_date:this.filter.end_date}});this.assets=o.data,console.table(this.assets)}catch(o){console.log(o)}},async fetchCustomers(){try{const o=await axios.get("/api/customer",{});this.customers=o.data,console.log(o.data)}catch(o){console.log(o)}},async fetchAssetsTypes(){try{const o=await axios.get("/api/assets_types",{});this.assets_types=o.data,console.log(o.data)}catch(o){console.log(o)}},formatAssets(){if(!this.assets||!this.assets.length)return[];const o=this.assets.map(s=>{let r={"Nro P처liza":s.insurance_policy_number,"Inicio Vigencia":s.start_date,"Fin Vigencia":s.end_date,"Nombre Cliente":s.customer_name,"Documento Cliente":s.customer_document,"Personas aseguradas":s.insuranced_people,"Tasa de riesgo":s.risk_rate,"Valor asegurado":s.insuranced_amount,"Comisi처n %":s.comission};return s.attributes&&s.attributes.length&&s.attributes.forEach(i=>{r[i.name]=i.value}),r});return console.dir(o),o},exportToExcel(){const o=this.formatAssets();if(!o||!o.length)return;const s=this.toCsv(o),r=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(r),t=document.createElement("a");t.setAttribute("href",i),t.setAttribute("download","ReporteDeActivo.csv"),document.body.appendChild(t),t.click()},toCsv(o){if(!o||!o.length)return"";const s=",",r=Object.keys(o[0]),i=r.join(s)+`
`,t=o.map(c=>r.map(g=>'"'+c[g]+'"').join(s)).join(`
`);return i+t},addIncident(o){window.location.href=`/admin/incidents/create/${o}`}},mounted(){this.fetchAssets(),this.fetchCustomers(),this.fetchAssetsTypes()},watch:{filter:{handler:"fetchAssets",deep:!0}}},ye=Object.assign(he,{__name:"Index",setup(o){return(s,r)=>{const i=y("Create");return l(),n(d,null,[u(x(w),{title:"Tipos de Clientes"}),u(k,null,{default:v(()=>[u(_,{breadcrumbs:o.breadcrumbs},null,8,["breadcrumbs"]),e("div",V,[e("div",C,[e("div",A,[T,p(e("select",{id:"countries","onUpdate:modelValue":r[0]||(r[0]=t=>s.filter.customer=t),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[(l(!0),n(d,null,m(s.customers,t=>(l(),n("option",{value:t.id},a(t.name),9,B))),256))],512),[[h,s.filter.customer]])]),e("div",H,[E,p(e("select",{id:"countries","onUpdate:modelValue":r[1]||(r[1]=t=>s.filter.type=t),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[(l(!0),n(d,null,m(s.assets_types,t=>(l(),n("option",{value:t.id},a(t.name),9,I))),256))],512),[[h,s.filter.type]])]),e("div",M,[Z,e("div",j,[D,p(e("input",{type:"date",style:{"background-color":"white"},"onUpdate:modelValue":r[2]||(r[2]=t=>s.filter.start_date=t),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[b,s.filter.start_date]])])]),e("div",L,[N,e("div",R,[U,p(e("input",{type:"date",style:{"background-color":"white"},"onUpdate:modelValue":r[3]||(r[3]=t=>s.filter.end_date=t),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[b,s.filter.end_date]])])]),e("div",F,[e("button",{type:"button",onClick:r[4]||(r[4]=t=>s.exportToExcel()),class:"text-white bg-green-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},O)])]),e("div",$,[e("table",z,[q,e("tbody",null,[(l(!0),n(d,null,m(s.assets,t=>(l(),n("tr",G,[e("th",J,[e("div",K,[e("a",{href:"/admin/insurance_policies/show/"+t.insurance_policy_id},a(t.insurance_policy_number)+" "+a(t.insurance_policy_id),9,Q),W,f(),X,e("button",{type:"button",onClick:c=>s.addIncident(t.id),class:"text-white bg-red-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-1 text-center uppercase"},te,8,Y)])]),e("td",se,a(t.start_date),1),e("td",oe,a(t.end_date),1),e("td",re,[e("span",ae,a(t.customer_name),1),le,f(" "+a(t.customer_document),1)]),e("td",ne,a(t.insuranced_people),1),e("td",ie,a(t.insuranced_amount),1),e("td",null,[e("table",ce,[e("tbody",null,[(l(!0),n(d,null,m(t.attributes,c=>(l(),n("tr",de,[e("th",ue,a(c.name),1),e("td",pe,a(c.value),1)]))),256))])])]),e("td",me,a(t.risk_rate)+"% | "+a(t.comission),1)]))),256))])])])]),u(i,{id:"createCustomerType"})]),_:1})],64)}}});export{ye as default};
