import{r as v,o as i,c as a,a as l,u as w,w as k,F as m,Z as A,b as e,e as r,i as d,g as c,j as C,f as _,t as u,l as V}from"./app-bd881049.js";import{A as N}from"./AdminLayout-aae52a9c.js";import{B as F}from"./Breadcrumb-b2724a4e.js";import y from"./AddCustomer-132883df.js";import f from"./AddPeopleToInsurance-96129c29.js";import h from"./AddNewAsset-e5998d4b.js";import b from"./AddFile-be074fae.js";import"./_plugin-vue_export-helper-c27b6911.js";const I={class:"px-2"},B={class:"space-y-12"},M={class:"border-b border-gray-900/10 pb-12"},U=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Crear una póliza nueva",-1),P=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Asegúrate de llenar todos los campos ",-1),H={class:"mt-10 grid grid-cols-1 gap-x-2 gap-y-4 sm:grid-cols-6"},L={class:"sm:col-span-2"},T=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[c(" Número de póliza "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),z={class:"mt-2"},Z={class:"bg-white flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},S=e("span",{class:"flex select-none items-center pl-3 text-gray-500 sm:text-sm"},"N° | ",-1),$={class:"sm:col-span-2"},E={for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"},D=e("i",{class:"fa-solid fa-user-plus font-xl"},null,-1),j=[D],O={class:"mt-2"},q={class:"sm:col-span-2"},R={for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"},Y=e("i",{class:"fa-solid fa-user-plus font-xl"},null,-1),G=[Y],J={class:"mt-2"},K={class:"sm:col-span-2"},Q=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[c(" Companía de Seguros "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),W={class:"mt-2"},X={class:"sm:col-span-2"},ee=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Inicio de Vigencia ",-1),se={class:"mt-4"},te={class:"relative"},ne=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),oe={class:"sm:col-span-2"},ie=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Fin de Vigencia ",-1),ae={class:"mt-4"},le={class:"relative"},re=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),ce={class:"sm:col-span-2"},de=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[c(" Tipo de comisión "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),ue={class:"mt-2"},pe={class:"sm:col-span-3"},me={class:"mt-2"},_e=e("option",{value:"1",selected:""},"% | PORCENTAJE",-1),ge=e("option",{value:"2"},"N° | NUMÉRICA",-1),ye=[_e,ge],fe={class:"sm:col-span-2"},he=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"},[c(" Comisión "),e("button",{type:"button",disabled:"",class:"ml-2 text-white bg-gray-800 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[e("i",{class:"fa-solid fa-tag font-xl"})])],-1),be={class:"mt-2"},xe={style:{"background-color":"white"},class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},ve=e("span",{class:"flex select-none items-center pl-3 text-gray-500 sm:text-sm"},"% |",-1),we={class:"sm:col-span-1 col-span"},ke=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"}," N° Cuotas ",-1),Ae={class:"mt-5"},Ce={style:{"background-color":"white"},class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},Ve=e("span",{class:"flex select-none items-center pl-3 text-gray-700 sm:text-sm"},"N°",-1),Ne={class:"sm:col-span-1"},Fe=e("label",{for:"username",class:"block text-sm font-medium leading-6 text-gray-900"}," Tasa de riesgo ",-1),Ie={class:"mt-5"},Be={style:{"background-color":"white"},class:"flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md"},Me=e("span",{class:"flex select-none items-center pl-3 text-gray-700 sm:text-sm"},"%",-1),Ue={class:"border-b border-gray-900/10 pb-12"},Pe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Activos",-1),He=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Lista de activos Asegurados ",-1),Le=e("i",{class:"ml-2 fa-solid fa-plus font-xl"},null,-1),Te={class:"sm:col-span-3"},ze={key:0,class:"w-full text-sm text-left text-gray-500"},Ze=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," Tipo "),e("th",{scope:"col",class:"px-6 py-3"}," Valor Asegurado "),e("th",{scope:"col",class:"px-6 py-3"}," Fecha de Vigencia "),e("th",{scope:"col",class:"px-6 py-3"}," Atributos "),e("th",{scope:"col",class:"px-6 py-3"}," Acciones ")])],-1),Se={class:"bg-white border-b hover:bg-gray-50"},$e={scope:"row",class:"px-6 py-4"},Ee={class:"px-6 py-4"},De={class:"px-6 py-4"},je={class:"px-6 py-4"},Oe={class:"w-full text-sm text-left text-gray-500 table"},qe={class:"text-xs text-gray-700 uppercase bg-gray-100"},Re={scope:"col",class:"px-6 py-3 text-center"},Ye={class:"px-6 py-4"},Ge=["onClick"],Je={key:1,class:"text-red-500"},Ke={class:"border-b border-gray-900/10 pb-12"},Qe=e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Archivos de la póliza",-1),We=e("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," Imágenes, PDF's, Excel y cualquier tipo de documento que esté relacionado a la poliza ",-1),Xe=e("i",{class:"ml-2 fa-solid fa-plus font-xl"},null,-1),es={class:"sm:col-span-3"},ss={class:"mt-10 grid grid-cols-8 gap-y-4"},ts={class:"sm:col-span-4 md:col-span-2 col-span-4"},ns={class:"w-48 text-gray-900 bg-white border border-gray-200 rounded-lg"},os=["onClick"],is=e("i",{class:"fa-solid fa-file mr-2"},null,-1),as=e("br",null,null,-1),ls={class:"mt-6 flex items-center justify-end gap-x-6"},rs=e("button",{type:"button",class:"text-sm font-semibold leading-6 text-gray-900"},"Cancelar",-1),cs={components:{AddCustomer:y,AddPeopleToInsurance:f,AddNewAsset:h,AddFile:b},props:["breadcrumbs","general_settings"],data(){return{insurance_policy:{number:null,insurance_policy_data:{customer_id:null,insurance_policies_status_id:1,insurance_company_id:null,start_date:null,end_date:null,comission_type_id:1,comission:this.general_settings.comission,number_of_installments:0,risk_rate:0,insurance_policy_people:[],insurance_policy_billing_contact:{name:null},insurance_policy_insuranced_people:[],assets:[],files:[],insurance_policies_data_files:[]}},customers:[],insurance_companies:[]}},methods:{async submit(){try{const t=await axios.post("/admin/insurance_policies/store",this.insurance_policy);window.location.href="/admin/insurance_policies"}catch(t){console.log(t)}},showModal(t){let s=document.getElementById(t);s.classList.remove("slide-out-bck-center"),s.classList.remove("no-display")},async getCustomers(){try{const t=await axios.get("/api/customer");this.customers=t.data}catch(t){console.log(t)}},async getInsuranceCompanies(){try{const t=await axios.get("/api/insurance_companies");this.insurance_companies=t.data}catch(t){console.log(t)}},handleNewFile(t){this.insurance_policy.insurance_policy_data.files.push(t)},removeFile(t){const s=this.insurance_policy.insurance_policy_data.files.findIndex(n=>n.name===t.name);s!==-1&&this.insurance_policy.insurance_policy_data.files.splice(s,1)},handleNewAsset(t){this.insurance_policy.insurance_policy_data.assets.push(t)},removeAsset(t){const s=this.insurance_policy.insurance_policy_data.assets.findIndex(n=>n.asset_type_id===t.asset_type_id&&n.insured_amount===t.insured_amount&&n.vigency_date===t.vigency_date);s!==-1&&this.insurance_policy.insurance_policy_data.assets.splice(s,1)},handleNewCustomer(t){this.customers.push(t),this.insurance_policy.insurance_policy_data.customer_id=t.id},handleNewPeople(t){console.table(t),t.type_id===1?(this.removePeopleByType(1),this.insurance_policy.insurance_policy_data.insurance_policy_people.push(t),this.setBillingContact(t)):t.type_id===2&&(this.insurance_policy.insurance_policy_data.insurance_policy_people.push(t),this.addInsurancedPeople(t))},removePeopleByType(t){const s=this.insurance_policy.insurance_policy_data.insurance_policy_people.findIndex(n=>n.type_id===t);s!==-1&&this.insurance_policy.insurance_policy_data.insurance_policy_people.splice(s,1)},setBillingContact(t){this.insurance_policy.insurance_policy_data.insurance_policy_billing_contact=t},addInsurancedPeople(t){this.insurance_policy.insurance_policy_data.insurance_policy_insuranced_people.push(t)},removeInsurancedPeople(t){this.removePeopleFromList(t,this.insurance_policy.insurance_policy_data.insurance_policy_insuranced_people),this.removePeopleFromList(t,this.insurance_policy.insurance_policy_data.insurance_policy_people)},removePeopleFromList(t,s){const n=s.findIndex(p=>p.document_number===t.document_number);n!==-1&&s.splice(n,1)}},mounted(){this.getCustomers(),this.getInsuranceCompanies()},watch:{"insurance_policy.insurance_policy_data.start_date":function(t){if(t){let s=new Date(t);s.setFullYear(s.getFullYear()+1),this.insurance_policy.insurance_policy_data.end_date=s.toISOString().split("T")[0]}},"insurance_policy.insurance_policy_data.customer_id":function(t){const s=this.customers.find(n=>n.id===t);s&&(this.insurance_policy.insurance_policy_data.insurance_policy_billing_contact=s)}}},hs=Object.assign(cs,{__name:"Create",setup(t){return(s,n)=>{const p=v("v-select");return i(),a(m,null,[l(w(A),{title:"Crear Póliza"}),l(N,null,{default:k(()=>[l(F,{breadcrumbs:t.breadcrumbs},null,8,["breadcrumbs"]),e("form",I,[e("div",B,[e("div",M,[U,P,e("div",H,[e("div",L,[T,e("div",z,[e("div",Z,[S,r(e("input",{type:"text",name:"number",id:"number",autocomplete:"number","onUpdate:modelValue":n[0]||(n[0]=o=>s.insurance_policy.number=o),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"000001"},null,512),[[d,s.insurance_policy.number]])])])]),e("div",$,[e("label",E,[c(" Contratante "),e("button",{type:"button",onClick:n[1]||(n[1]=o=>s.showModal("AddCustomer")),class:"ml-2 text-white bg-green-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},j),l(y,{id:"AddCustomer",onCustomerAdded:s.handleNewCustomer},null,8,["onCustomerAdded"])]),e("div",O,[l(p,{modelValue:s.insurance_policy.insurance_policy_data.customer_id,"onUpdate:modelValue":n[2]||(n[2]=o=>s.insurance_policy.insurance_policy_data.customer_id=o),options:s.customers,style:{"background-color":"white"},reduce:o=>o.id,label:"name"},null,8,["modelValue","options","reduce"])])]),e("div",q,[e("label",R,[c(" Responsable de pago "),e("button",{type:"button",onClick:n[3]||(n[3]=o=>s.showModal("AddBillingContact")),class:"ml-2 text-white bg-green-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-2 py-2 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},G),l(f,{id:"AddBillingContact",type:1,onPeopleAdded:s.handleNewPeople},null,8,["onPeopleAdded"])]),e("div",J,[r(e("input",{type:"text",placeholder:"Responsable de pago",disabled:"","onUpdate:modelValue":n[4]||(n[4]=o=>s.insurance_policy.insurance_policy_data.insurance_policy_billing_contact.name=o),class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,512),[[d,s.insurance_policy.insurance_policy_data.insurance_policy_billing_contact.name]])])]),e("div",K,[Q,e("div",W,[l(p,{modelValue:s.insurance_policy.insurance_policy_data.insurance_company_id,"onUpdate:modelValue":n[5]||(n[5]=o=>s.insurance_policy.insurance_policy_data.insurance_company_id=o),style:{"background-color":"white"},options:s.insurance_companies,reduce:o=>o.id,label:"name"},null,8,["modelValue","options","reduce"])])]),e("div",X,[ee,e("div",se,[e("div",te,[ne,r(e("input",{type:"date","onUpdate:modelValue":n[6]||(n[6]=o=>s.insurance_policy.insurance_policy_data.start_date=o),style:{"background-color":"white"},class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[d,s.insurance_policy.insurance_policy_data.start_date]])])])]),e("div",oe,[ie,e("div",ae,[e("div",le,[re,r(e("input",{type:"date","onUpdate:modelValue":n[7]||(n[7]=o=>s.insurance_policy.insurance_policy_data.end_date=o),style:{"background-color":"white"},class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[d,s.insurance_policy.insurance_policy_data.end_date]])])])]),e("div",ce,[de,e("div",ue,[e("div",pe,[e("div",me,[r(e("select",{id:"country",name:"country",autocomplete:"country-name",style:{"background-color":"white"},"onUpdate:modelValue":n[8]||(n[8]=o=>s.insurance_policy.insurance_policy_data.comission_type_id=o),class:"bg-transparent block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6"},ye,512),[[C,s.insurance_policy.insurance_policy_data.comission_type_id]])])])])]),e("div",fe,[he,e("div",be,[e("div",xe,[ve,r(e("input",{type:"number",name:"number",id:"number",autocomplete:"number","onUpdate:modelValue":n[9]||(n[9]=o=>s.insurance_policy.insurance_policy_data.comission=o),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"12.0"},null,512),[[d,s.insurance_policy.insurance_policy_data.comission]])])])]),e("div",we,[ke,e("div",Ae,[e("div",Ce,[Ve,r(e("input",{type:"number","onUpdate:modelValue":n[10]||(n[10]=o=>s.insurance_policy.insurance_policy_data.number_of_installments=o),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"5"},null,512),[[d,s.insurance_policy.insurance_policy_data.number_of_installments]])])])]),e("div",Ne,[Fe,e("div",Ie,[e("div",Be,[Me,r(e("input",{type:"text","onUpdate:modelValue":n[11]||(n[11]=o=>s.insurance_policy.insurance_policy_data.risk_rate=o),class:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6",placeholder:"2.8"},null,512),[[d,s.insurance_policy.insurance_policy_data.risk_rate]])])])])])]),e("div",Ue,[Pe,He,e("button",{type:"button",onClick:n[12]||(n[12]=o=>s.showModal("NewAsset")),class:"mt-1 text-white bg-indigo-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[c(" Añadir Activo "),Le]),l(h,{id:"NewAsset",onAssetAdded:s.handleNewAsset,policy_vigency_date:s.insurance_policy.insurance_policy_data.end_date},null,8,["onAssetAdded","policy_vigency_date"]),e("div",Te,[s.insurance_policy.insurance_policy_data.assets.length>0?(i(),a("table",ze,[Ze,e("tbody",null,[(i(!0),a(m,null,_(s.insurance_policy.insurance_policy_data.assets,(o,x)=>(i(),a("tr",Se,[e("td",$e,u(o.asset_type_name),1),e("td",Ee,u(o.insured_amount),1),e("td",De,u(o.vigency_date),1),e("td",je,[e("table",Oe,[e("thead",qe,[e("tr",null,[(i(!0),a(m,null,_(o.assets_attributes_data,g=>(i(),a("th",Re,u(g),1))),256))])])])]),e("td",Ye,[e("i",{onClick:g=>s.removeAsset(o),class:"fa-solid fa-trash text-3xl text-red-500 cursor-pointer ml-2"},null,8,Ge)])]))),256))])])):(i(),a("h1",Je," No haz añadido ningún activo "))])]),e("div",Ke,[Qe,We,e("button",{type:"button",onClick:n[13]||(n[13]=o=>s.showModal("AddFile")),class:"mt-1 text-white bg-indigo-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},[c(" Añadir Archivo "),Xe]),l(b,{id:"AddFile",onFileAdded:s.handleNewFile},null,8,["onFileAdded"]),e("div",es,[e("div",ss,[(i(!0),a(m,null,_(s.insurance_policy.insurance_policy_data.files,o=>(i(),a("div",ts,[e("div",ns,[e("button",{type:"button",onClick:x=>s.removeFile(o),class:"relative inline-flex items-center w-full px-4 py-2 text-sm font-medium border-b border-gray-200 rounded-t-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:focus:ring-gray-500 dark:focus:text-white"},[is,e("span",null,u(o.name.length>10?o.name.slice(0,10)+"...":o.name),1),as],8,os)])]))),256))])])])]),e("div",ls,[rs,e("button",{type:"button",onClick:n[14]||(n[14]=V((...o)=>s.submit&&s.submit(...o),["prevent"])),class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"}," Guardar ")])])]),_:1})],64)}}});export{hs as default};
