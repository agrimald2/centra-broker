import{r as f,o as l,c as n,a as p,u as y,w as x,F as i,Z as v,b as e,d as m,v as h,e as u,t as a,f as b,g as w}from"./app-17ec879b.js";import{A as k}from"./AdminLayout-0faca90f.js";import{B as g}from"./Breadcrumb-f6b6f371.js";import"./_plugin-vue_export-helper-c27b6911.js";const V={class:"shadow-md sm:rounded-lg relative"},C={class:"px-4 flex items-center py-4 bg-white"},A={class:"mt-4 mx-2"},T=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Cliente ",-1),B=["value"],H={class:"mt-4 mx-2"},j=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Tipo de Activo ",-1),M=["value"],Z={class:"mt-4 mx-2"},D=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Inicio Vigencia ",-1),E={class:"relative"},L=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),N={class:"mt-4 mx-2"},R=e("label",{for:"first-name",class:"block text-sm font-medium leading-6 text-gray-900"}," Fin Vigencia ",-1),U={class:"relative"},F=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1),I={class:"mt-4 mx-2 pt-5"},P=e("span",{class:"hidden md:flex"}," Excel",-1),S=e("i",{class:"ml-2 fa-solid fa-file-excel font-xl"},null,-1),O=[P,S],$={class:"overflow-x-auto"},z={class:"w-full text-sm text-left text-gray-500"},q=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," N째 Poliza "),e("th",{scope:"col",class:"px-6 py-3"}," Inicio Vigencia "),e("th",{scope:"col",class:"px-6 py-3"}," Fin Vigencia "),e("th",{scope:"col",class:"px-6 py-3"}," Cliente "),e("th",{scope:"col",class:"px-6 py-3"}," Persona As. "),e("th",{scope:"col",class:"px-6 py-3"}," Valor As. "),e("th",{scope:"col",class:"px-6 py-3"}," Atributos "),e("th",{scope:"col",class:"px-6 py-3"}," TR | Comisi처n ")])],-1),G={class:"bg-white border-b hover:bg-gray-50"},J={scope:"row",class:"flex items-center px-6 py-4 text-gray-900 whitespace-nowrap"},K={class:"text-base font-semibold"},Q={class:"px-6 py-4"},W={class:"px-6 py-4"},X={class:"px-6 py-4"},Y={class:"text-base font-semibold"},ee=e("br",null,null,-1),te={class:"px-6 py-4"},se={class:"px-6 py-4"},oe={class:"w-full text-sm text-left text-gray-500 table"},re={class:"text-xs text-gray-700 uppercase bg-gray-100"},ae={scope:"col",class:"px-3 py-1 text-center"},le={scope:"row",class:"flex items-center px-2 py-1 text-gray-900 whitespace-nowrap"},ne={class:"py-2"},ie={class:"px-6 py-4"},ce={components:{Breadcrumb:g},props:["breadcrumbs"],data(){return{filter:{type:null,start_date:null,end_date:null,customer:null},assets:[],customers:[],assets_types:[]}},methods:{showModal(o){let t=document.getElementById(o);t.classList.remove("slide-out-bck-center"),t.classList.remove("no-display")},async fetchAssets(){try{const o=await axios.get("/admin/assets/get",{params:{customer:this.filter.customer,type:this.filter.type,start_date:this.filter.start_date,end_date:this.filter.end_date}});this.assets=o.data,console.table(this.assets)}catch(o){console.log(o)}},async fetchCustomers(){try{const o=await axios.get("/api/customer",{});this.customers=o.data,console.log(o.data)}catch(o){console.log(o)}},async fetchAssetsTypes(){try{const o=await axios.get("/api/assets_types",{});this.assets_types=o.data,console.log(o.data)}catch(o){console.log(o)}},formatAssets(){if(!this.assets||!this.assets.length)return[];const o=this.assets.map(t=>({"Nro P처liza":t.insurance_policy_number,"Inicio Vigencia":t.start_date,"Fin Vigencia":t.end_date,"Nombre Cliente":t.customer_name,"Documento Cliente":t.customer_document,"Personas aseguradas":t.insuranced_people,Atributos:t.attributes&&t.attributes.length?t.attributes.map(r=>`${r.name}: ${r.value}`).join(", "):"","Tasa de riesgo":t.risk_rate,"Valor asegurado":t.insuranced_amount,"Comisi처n %":t.comission}));return console.dir(o),o},exportToExcel(){const o=this.formatAssets();if(!o||!o.length)return;const t=this.toCsv(o),r=new Blob([t],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(r),s=document.createElement("a");s.setAttribute("href",c),s.setAttribute("download","ReporteDeActivo.csv"),document.body.appendChild(s),s.click()},toCsv(o){if(!o||!o.length)return"";const t=",",r=Object.keys(o[0]),c=r.join(t)+`
`,s=o.map(d=>r.map(_=>'"'+d[_]+'"').join(t)).join(`
`);return c+s}},mounted(){this.fetchAssets(),this.fetchCustomers(),this.fetchAssetsTypes()},watch:{filter:{handler:"fetchAssets",deep:!0}}},he=Object.assign(ce,{__name:"Index",setup(o){return(t,r)=>{const c=f("Create");return l(),n(i,null,[p(y(v),{title:"Tipos de Clientes"}),p(k,null,{default:x(()=>[p(g,{breadcrumbs:o.breadcrumbs},null,8,["breadcrumbs"]),e("div",V,[e("div",C,[e("div",A,[T,m(e("select",{id:"countries","onUpdate:modelValue":r[0]||(r[0]=s=>t.filter.customer=s),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[(l(!0),n(i,null,u(t.customers,s=>(l(),n("option",{value:s.id},a(s.name),9,B))),256))],512),[[h,t.filter.customer]])]),e("div",H,[j,m(e("select",{id:"countries","onUpdate:modelValue":r[1]||(r[1]=s=>t.filter.type=s),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[(l(!0),n(i,null,u(t.assets_types,s=>(l(),n("option",{value:s.id},a(s.name),9,M))),256))],512),[[h,t.filter.type]])]),e("div",Z,[D,e("div",E,[L,m(e("input",{type:"date",style:{"background-color":"white"},"onUpdate:modelValue":r[2]||(r[2]=s=>t.filter.start_date=s),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[b,t.filter.start_date]])])]),e("div",N,[R,e("div",U,[F,m(e("input",{type:"date",style:{"background-color":"white"},"onUpdate:modelValue":r[3]||(r[3]=s=>t.filter.end_date=s),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"},null,512),[[b,t.filter.end_date]])])]),e("div",I,[e("button",{type:"button",onClick:r[4]||(r[4]=s=>t.exportToExcel()),class:"text-white bg-green-800 hover:bg-[#050708]/80 focus:ring-4 focus:outline-none focus:ring-[#050708]/50 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-gray-600 mr-2 mb-2"},O)])]),e("div",$,[e("table",z,[q,e("tbody",null,[(l(!0),n(i,null,u(t.assets,s=>(l(),n("tr",G,[e("th",J,[e("div",K,a(s.insurance_policy_number),1)]),e("td",Q,a(s.start_date),1),e("td",W,a(s.end_date),1),e("td",X,[e("span",Y,a(s.customer_name),1),ee,w(" "+a(s.customer_document),1)]),e("td",te,a(s.insuranced_people),1),e("td",se,a(s.insuranced_amount),1),e("td",null,[e("table",oe,[e("thead",re,[e("tr",null,[(l(!0),n(i,null,u(s.attributes,d=>(l(),n("th",ae,a(d.name),1))),256))])]),e("tbody",null,[e("tr",le,[(l(!0),n(i,null,u(s.attributes,d=>(l(),n("td",ne,a(d.value),1))),256))])])])]),e("td",ie,a(s.risk_rate)+"% | "+a(s.comission),1)]))),256))])])])]),p(c,{id:"createCustomerType"})]),_:1})],64)}}});export{he as default};
